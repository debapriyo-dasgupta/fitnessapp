pipeline 
{
    agent any
    environment 
    {
        git_dev_branch_name = 'master'
    }    
    stages 
    {
        stage('Initialize') {
            steps {
                script {
                    // Define the Docker tool's home directory
                    def dockerHome = tool name: 'docker'

                    // Update the PATH environment variable to include the Docker binary directory
                    env.PATH = "${dockerHome}/bin:${env.PATH}"
                }
            }
        }
        stage('CODE ANALYSIS') 
        {         
            steps 
            {       
                sh "echo 'Performing Code Analysis'"
            }
        }  
        stage('BUILD IMAGE') 
        {         
            steps 
            {
                sh "chmod +x -R ${env.WORKSPACE}"             
                sh "infra/pipeline/common.lib/build/build-image-task.sh"
            }
        }
        stage('IMAGE PUSH') 
        {         
            steps 
            {      
                sh "infra/pipeline/common.lib/build/push-image-repo.sh"
            }
        }   
        stage('UNIT TEST') 
        {         
            steps 
            {       
                sh "infra/pipeline/common.lib/test/tests-task.sh"
            }
        }  
        stage('FUNCTIONAL TEST') 
        {         
            steps 
            {       
                sh "infra/pipeline/common.lib/test/tests-task.sh"
            }
        }  
             
    }                                   
    post 
    { 
        always 
        { 
            cleanWs()
        }
    }       
}